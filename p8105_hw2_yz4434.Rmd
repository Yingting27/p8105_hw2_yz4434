---
title: "Homework"
output: github_document
---

```{r}
library(tidyverse)
```

## Question 2
```{r}
mr_trash_wheel_df = 
  readxl::read_excel("data/202309_Trash_Wheel_Collection_Data.xlsx", sheet = 1, range = "A2:N586") |>
  janitor::clean_names() |> 
  drop_na(dumpster) |> 
  mutate(
    homes_powered = weight_tons*500/30,
    trash_wheel_types = "Mr_trash_wheel"
  )
mr_trash_wheel_df$year = as.character(mr_trash_wheel_df$year)
```

# Import, clean, and organize the data for Professor Trash Wheel and Gwynnda

* Professor Trash Wheel

```{r}
prof_trash_wheel_df = 
  readxl::read_excel("data/202309_Trash_Wheel_Collection_Data.xlsx", sheet = 2, range = "A2:M108") |> 
  janitor::clean_names() |> 
  drop_na(dumpster) |> 
  mutate(
    homes_powered = weight_tons*500/30,
    trash_wheel_types = "professor_trash_wheel"
  )
prof_trash_wheel_df$year = as.character(prof_trash_wheel_df$year)
```


* Gwynnda Trash Wheel

```{r}
gwy_trash_wheel_df = 
  readxl::read_excel("data/202309_Trash_Wheel_Collection_Data.xlsx", sheet = 4, range = "A2:L157") |> 
  janitor::clean_names() |> 
  drop_na(dumpster) |> 
  mutate(
    homes_powered = weight_tons*500/30,
    trash_wheel_types = "Gwynnda_trash_wheel"
  )
gwy_trash_wheel_df$year = as.character(gwy_trash_wheel_df$year)
```


## Merging

```{r}
combine_sheet_df = 
  bind_rows(mr_trash_wheel_df,prof_trash_wheel_df,gwy_trash_wheel_df) |>
  janitor::clean_names() |> 
  relocate(trash_wheel_types)
```

* Calculate the total number of cigarette butts in 07/2021
```{r}
total_cigarettes = filter(gwy_trash_wheel_df, year == "2021", month == "July")
```


* Descriptions:
According to the results of combine sheet, we can see that there are **`r nrow(combine_sheet_df)` rows**, with **`r ncol(combine_sheet_df)` columns** in total. The key variables include **`r names(combine_sheet_df)`**. The total weight of trash collected by Professor Trash Wheel is **`r sum(prof_trash_wheel_df$weight_tons)`**. The total number of cigarette butts collected by Gwynnda in July of 2021 is **`r sum(total_cigarettes$cigarette_butts)`**

# Question 3

## Import dataset
```{r}
baseline_df =
  read_csv("data/MCI_baseline.csv", skip =1) |> 
  janitor::clean_names() |> 
  filter(current_age < age_at_onset & age_at_onset != ".") |> 
    mutate(
    sex = case_match(
      sex,
      1 ~ "male",
      0 ~ "female"
      )
) |> 
    mutate(
    apoe4 = case_match(
        apoe4,
        1 ~ "APOE4_carrier",
        0 ~ "APOE4_non_carrier"
      )
)
```

* Discuss important steps in the import process and relevant features of the dataset
According to the important process, we can see that we filter all information that meet this study inclusion criteria. Firstly, we delete the age onset data which is larger than current because current age would not be large than age at onset since this study need those participants who get disease after joining the study. Secondly, when we omit the missing data with only showing data of , we filter those participants who lost follow-up during the study. These steps are important, because

* How many participants were recruited, and of these how many develop MCI? 

the number of original data
```{r}
total_baseline_df =
  read_csv("data/MCI_baseline.csv", skip =1) |> 
  janitor::clean_names() |> 
  filter (current_age < age_at_onset | age_at_onset == ".") |> 
    mutate(
    sex = case_match(
      sex,
      1 ~ "male",
      0 ~ "female"
      )
) |> 
    mutate(
    apoe4 = case_match(
        apoe4,
        1 ~ "APOE4_carrier",
        0 ~ "APOE4_non_carrier"
      )
)
```
There are `r nrow(total_baseline_df)` participants that were recruited, and `r nrow(baseline_df)` of these develop MCI.

* What is the average baseline age? 
```{r}
baseline_df$age_at_onset = as.numeric(baseline_df$current_age)
```

The average baseline age is `r mean(baseline_df$current_age)`. The proportion of women in the study are APOE4 carriers

* What proportion of women in the study are APOE4 carriers?

```{r}
prop_women = sum(total_baseline_df$sex == "female" & total_baseline_df$apoe4 == "APOE4_carrier") / sum(total_baseline_df$sex == "female")
```

The proportion of `r prop_women` women in the study are APOE4 carriers


# Import the dataset of longitudinally

```{r}
amyloid_df =
  read_csv("data/mci_amyloid.csv", skip =1) |> 
  janitor::clean_names()
```

